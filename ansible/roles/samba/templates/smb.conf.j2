[global]
   workgroup = {{ samba_workgroup }}
   server string = {{ samba_server_string }}
   netbios name = {{ samba_netbios_name }}
   
   # Network security
   hosts allow = {{ samba_hosts_allow }}
   hosts deny = {{ samba_hosts_deny }}
   
   # Authentication settings
   security = user
   map to guest = bad user
   guest account = nobody
   
   # Logging
   log file = /var/log/samba/log.%m
   max log size = 1000
   
   # Performance and compatibility
   socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=131072 SO_SNDBUF=131072
   read raw = yes
   write raw = yes
   
   # Disable printing
   load printers = no
   printing = bsd
   printcap name = /dev/null
   disable spoolss = yes

{% for share in samba_shares %}
[{{ share.name }}]
   comment = {{ share.comment }}
   path = {{ share.path }}
   browseable = {{ share.browseable | default('yes') }}
   guest ok = {{ share.guest_ok | default('no') }}
   read only = {{ share.read_only | default('yes') }}
   create mask = {{ share.create_mask | default('0644') }}
   directory mask = {{ share.directory_mask | default('0755') }}
{% if share.valid_users is defined %}
   valid users = {{ share.valid_users }}
{% endif %}
{% if share.write_list is defined %}
   write list = {{ share.write_list }}
{% endif %}

{% endfor %}